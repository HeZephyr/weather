{"remainingRequest":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\src\\components\\History.vue?vue&type=style&index=0&id=aa4ea6d8&lang=less&scoped=true&","dependencies":[{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\src\\components\\History.vue","mtime":1641373803164},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5ib3ggewogIHdpZHRoOiAxMDAlOwogIGhlaWdodDogMTAwJTsKICAubnVsbHZpZXcgewogICAgd2lkdGg6IDEwMCU7CiAgICBoZWlnaHQ6IDUwcHg7CiAgfQogIC5saW5lIHsKICAgIHdpZHRoOiA5OSU7CiAgICBoZWlnaHQ6IDQwMHB4OwogICAgbWFyZ2luLXRvcDogMjBweDsKICAgIC8vIGNvbG9yOiAjODg4Njg2OwogIH0KfQo="},{"version":3,"sources":["History.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"History.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"box\">\n    <div class=\"nullview\"></div>\n    <van-form>\n      <van-field\n        v-model=\"dataNum\"\n        center\n        label=\"数据数量\"\n        clearable\n        placeholder=\"1 ~ 330\"\n        :rules=\"[{ pattern, message: '请输入正确的数字', trigger: 'onBlur' }]\"\n      >\r\n\t\t\t\t<template #button>\r\n\t\t\t\t\t<van-button size=\"small\" type=\"primary\" @click=\"selectData\"\r\n\t\t\t\t\t\t>查询</van-button\r\n\t\t\t\t\t>\r\n\t\t\t\t</template>\n      </van-field>    \n    </van-form>\n    <van-tabs color=\"#888686\" @click=\"tabClick\">\n      <van-tab title=\"温度\">\n        <div class=\"line\">\n          <div id=\"main\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n      <van-tab title=\"湿度\">\n        <div class=\"line\">\n          <div id=\"main1\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n      <van-tab title=\"光照强度\">\n        <div class=\"line\">\n          <div id=\"main2\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n    </van-tabs>\n  </div>\n</template>\n\n<script>\nlet echarts = require('echarts'); // 加载echarts\nlet devicesid = '624519850'; // 设备id\nlet apikey = '2oc6=0XgNsKFW8XVsGcpSJmdlL0='; // oneNetApi的key\nlet api = new OneNetApi(apikey); //读取设备获取多个数据流。\n\nexport default {\n  created() {\n    // 获取数据节点，通过组件id来锁定获取哪个数据项\n    this.getCharts('temperature', '温度', '#F60', 'main');\n  },\n  data() {\n    return {\n      flag: true,\n      flag1: true,\n      value: '2021-05-01',\n      dataNum: '',\n      limit: 6000,\n      startTime: '2020-12-30T08:00:35',\n      dataL: {},\n      dataH: {},\n      dataT: {},\n      pattern: /^([1-9][0-9]|[1-2][0-9][0-9]|[3][0-2][0-9]|330)$/\n    };\n  },\n  mounted() {},\n  methods: {\r\n\t\t// 设置响应组件函数，判断当前是选择根据哪个参数跑数据图。\n    tabClick(title) {\n      if (title === 1 && this.flag) {\n        this.flag = !this.flag;\n        this.getCharts('humidity', '湿度', '#1be0e0', 'main1');\n      } else if (title === 2 && this.flag1) {\n        this.flag1 = !this.flag1;\n        // 获取光照度的数据节点\n        this.getCharts('illumination', '光照强度', '#19c509', 'main2');\n      }\n    },\n    selectData() {\n      // 查询按钮\n      const that = this;\n      const dataNums = Number(that.dataNum);\n      that.limit = dataNums;\n      that.getCharts('temperature', '温度', '#F60', 'main');\n      that.getCharts('humidity', '湿度', '#1be0e0', 'main1');\n      that.getCharts('illumination', '光照强度', '#19c509', 'main2');\n    },\n    getCharts(id, title, color, who) {\n      // 实例化图表\n      const that = this;\r\n\t\t\t// 通过oneNetApi获取数据\n      api.getDataPoints(devicesid, {\n          datastream_id: id,\n          start: that.startTime,\n          limit: that.limit\n        })\n        .done(function(data) {\n          console.log('api调用完成，服务器返回data为：', data);\r\n\t\t\t\t\t// 对数据进行处理\n          const tdatatime = [];\n          const tvalue = [];\n          const datas = data.data.datastreams[0].datapoints;\n          for (const i in datas) {\n            datas[i].at = datas[i].at.slice(5, -4); // 去掉时间，保留日期\n            tdatatime.push(datas[i].at);\n            tvalue.push(datas[i].value);\n          }\n          // const echarts = require(\"echarts\");\n          // 基于准备好的dom，初始化echarts实例\n          const myChart = echarts.init(document.getElementById(who));\n          // 指定图表的配置项和数据。\n          const option = {\n            legend: {\n              data: [title]\n            },\n            tooltip: {},\n            toolbox: {\n              feature: {\n                // 动态类型切换,切换图表，我这里设置直方图和折线图。\n                magicType: {\n                  type: ['line', 'bar']\n                },\n                // 数据视图工具，可以展现当前图表所用的数据，编辑后可以动态更新。\n                dataView: {\n                  show: true, // 是否显示 数据示图\n                  readOnly: false // 是否 直接可以编辑数据。\n                },\n                // 保存为图片的配置\n                saveAsImage: {\n                  show: true\n                },\n                // 配置项还原\n                restore: { show: true }\n              }\n            },\n            xAxis: [\n              {\n                data: tdatatime,\n                // 字数超过n个时省略\n                axisLabel: {\n                  formatter: function(value, index) {\n                    const v = value.substring(0, 5) + '...';\n                    return value.length > 5 ? v : value;\n                  }\n                }\n              }\n            ],\n            yAxis: {},\n            series: [\n              {\n                name: title,\n                type: 'line',\n                data: tvalue,\n                itemStyle: {\n                  // 图形的颜色。默认指向全局的option.color\n                  color: color\n                }\n              }\n            ]\n          };\r\n\t\t\t\t\t// 根据不同的选项来设置不同的数据项\n          if (id === 'temperature') {\n            that.dataT = option;\n          }\n          if (id === 'humidity') {\n            that.dataH = option;\n          }\n          if (id === 'illumination') {\n            that.dataL = option;\n          }\r\n\t\t\t\t\t// 绘制图表\n          myChart.setOption(option);\n        });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.box {\n  width: 100%;\n  height: 100%;\n  .nullview {\n    width: 100%;\n    height: 50px;\n  }\n  .line {\n    width: 99%;\n    height: 400px;\n    margin-top: 20px;\n    // color: #888686;\n  }\n}\n</style>\n"]}]}