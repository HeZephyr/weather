{"remainingRequest":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\src\\components\\History.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\src\\components\\History.vue","mtime":1641178878145},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\pursuit\\Desktop\\Documents\\移动应用开发\\smart-office-design\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IGVjaGFydHMgPSByZXF1aXJlKCdlY2hhcnRzJyk7CmNvbnN0IGRldmljZXNpZCA9ICc2MjQ1MTk4NTAnOyAvLyDorr7lpIdpZApjb25zdCBhcGlrZXkgPSAnMm9jNj0wWGdOc0tGVzhYVnNHY3BTSm1kbEwwPSc7IC8vCmNvbnN0IGFwaSA9IG5ldyBPbmVOZXRBcGkoYXBpa2V5KTsKCmV4cG9ydCBkZWZhdWx0IHsKICBjcmVhdGVkKCkgewogICAgLy8g6I635Y+W5rip5bqm55qE5pWw5o2u6IqC54K5CiAgICB0aGlzLmdldENoYXJ0cygndGVtcGVyYXR1cmUnLCAn5rip5bqmJywgJyNGNjAnLCAnbWFpbicpOwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZsYWc6IHRydWUsCiAgICAgIGZsYWcxOiB0cnVlLAogICAgICB2YWx1ZTogJzIwMjEtMDUtMDEnLAogICAgICBkYXRhTnVtOiAnJywKICAgICAgbGltaXQ6IDYwMDAsCiAgICAgIHN0YXJ0VGltZTogJzIwMjAtMTItMzBUMDg6MDA6MzUnLAogICAgICBkYXRhTDoge30sCiAgICAgIGRhdGFIOiB7fSwKICAgICAgZGF0YVQ6IHt9LAogICAgICBwYXR0ZXJuOiAvXihbMS05XVswLTldfFsxLTJdWzAtOV1bMC05XXxbM11bMC0yXVswLTldfDMzMCkkLwogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7fSwKICBtZXRob2RzOiB7CiAgICB0YWJDbGljayh0aXRsZSkgewogICAgICBpZiAodGl0bGUgPT09IDEgJiYgdGhpcy5mbGFnKSB7CiAgICAgICAgdGhpcy5mbGFnID0gIXRoaXMuZmxhZzsKICAgICAgICB0aGlzLmdldENoYXJ0cygnaHVtaWRpdHknLCAn5rm/5bqmJywgJyMxYmUwZTAnLCAnbWFpbjEnKTsKICAgICAgfSBlbHNlIGlmICh0aXRsZSA9PT0gMiAmJiB0aGlzLmZsYWcxKSB7CiAgICAgICAgdGhpcy5mbGFnMSA9ICF0aGlzLmZsYWcxOwogICAgICAgIC8vIC8v6I635Y+W5YWJ54Wn5bqm55qE5pWw5o2u6IqC54K5CiAgICAgICAgdGhpcy5nZXRDaGFydHMoJ2lsbHVtaW5hdGlvbicsICflhYnnhaflvLrluqYnLCAnIzE5YzUwOScsICdtYWluMicpOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0RGF0YSgpIHsKICAgICAgLy8g5p+l6K+i5oyJ6ZKuCiAgICAgIGNvbnN0IHRoYXQgPSB0aGlzOwogICAgICBjb25zdCBkYXRhTnVtcyA9IE51bWJlcih0aGF0LmRhdGFOdW0pOwogICAgICB0aGF0LmxpbWl0ID0gZGF0YU51bXM7CiAgICAgIHRoYXQuZ2V0Q2hhcnRzKCd0ZW1wZXJhdHVyZScsICfmuKnluqYnLCAnI0Y2MCcsICdtYWluJyk7CiAgICAgIHRoYXQuZ2V0Q2hhcnRzKCdodW1pZGl0eScsICfmub/luqYnLCAnIzFiZTBlMCcsICdtYWluMScpOwogICAgICB0aGF0LmdldENoYXJ0cygnaWxsdW1pbmF0aW9uJywgJ+WFieeFp+W8uuW6picsICcjMTljNTA5JywgJ21haW4yJyk7CiAgICB9LAogICAgZ2V0Q2hhcnRzKGlkLCB0aXRsZSwgY29sb3IsIHdobykgewogICAgICAvLyDlrp7kvovljJblm77ooagKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CiAgICAgIGFwaQogICAgICAgIC5nZXREYXRhUG9pbnRzKGRldmljZXNpZCwgewogICAgICAgICAgZGF0YXN0cmVhbV9pZDogaWQsCiAgICAgICAgICBzdGFydDogdGhhdC5zdGFydFRpbWUsCiAgICAgICAgICBsaW1pdDogdGhhdC5saW1pdAogICAgICAgIH0pCiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSkgewogICAgICAgICAgY29uc29sZS5sb2coJ2Fwaeiwg+eUqOWujOaIkO+8jOacjeWKoeWZqOi/lOWbnmRhdGHkuLrvvJonLCBkYXRhKTsKICAgICAgICAgIGNvbnN0IHRkYXRhdGltZSA9IFtdOwogICAgICAgICAgY29uc3QgdHZhbHVlID0gW107CiAgICAgICAgICBjb25zdCBkYXRhcyA9IGRhdGEuZGF0YS5kYXRhc3RyZWFtc1swXS5kYXRhcG9pbnRzOwogICAgICAgICAgZm9yIChjb25zdCBpIGluIGRhdGFzKSB7CiAgICAgICAgICAgIGRhdGFzW2ldLmF0ID0gZGF0YXNbaV0uYXQuc2xpY2UoNSwgLTQpOyAvLyDljrvmjonml7bpl7TvvIzkv53nlZnml6XmnJ8KICAgICAgICAgICAgdGRhdGF0aW1lLnB1c2goZGF0YXNbaV0uYXQpOwogICAgICAgICAgICB0dmFsdWUucHVzaChkYXRhc1tpXS52YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBjb25zdCBlY2hhcnRzID0gcmVxdWlyZSgiZWNoYXJ0cyIpOwogICAgICAgICAgLy8g5Z+65LqO5YeG5aSH5aW955qEZG9t77yM5Yid5aeL5YyWZWNoYXJ0c+WunuS+iwogICAgICAgICAgY29uc3QgbXlDaGFydCA9IGVjaGFydHMuaW5pdChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh3aG8pKTsKICAgICAgICAgIC8vIOe7mOWItuWbvuihqAogICAgICAgICAgY29uc3Qgb3B0aW9uID0gewogICAgICAgICAgICBsZWdlbmQ6IHsKICAgICAgICAgICAgICBkYXRhOiBbdGl0bGVdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvb2x0aXA6IHt9LAogICAgICAgICAgICB0b29sYm94OiB7CiAgICAgICAgICAgICAgZmVhdHVyZTogewogICAgICAgICAgICAgICAgLy8g5Yqo5oCB57G75Z6L5YiH5o2iLOWIh+aNouWbvuihqAogICAgICAgICAgICAgICAgbWFnaWNUeXBlOiB7CiAgICAgICAgICAgICAgICAgIHR5cGU6IFsnbGluZScsICdiYXInXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIC8vIOaVsOaNruinhuWbvuW3peWFt++8jOWPr+S7peWxleeOsOW9k+WJjeWbvuihqOaJgOeUqOeahOaVsOaNru+8jOe8lui+keWQjuWPr+S7peWKqOaAgeabtOaWsOOAggogICAgICAgICAgICAgICAgZGF0YVZpZXc6IHsKICAgICAgICAgICAgICAgICAgc2hvdzogdHJ1ZSwgLy8g5piv5ZCm5pi+56S6IOaVsOaNruekuuWbvgogICAgICAgICAgICAgICAgICByZWFkT25seTogZmFsc2UgLy8g5piv5ZCmIOebtOaOpeWPr+S7pee8lui+keaVsOaNruOAggogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIC8vIOS/neWtmOS4uuWbvueJh+eahOmFjee9rgogICAgICAgICAgICAgICAgc2F2ZUFzSW1hZ2U6IHsKICAgICAgICAgICAgICAgICAgc2hvdzogdHJ1ZQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIC8vIOmFjee9rumhuei/mOWOnwogICAgICAgICAgICAgICAgcmVzdG9yZTogeyBzaG93OiB0cnVlIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHhBeGlzOiBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgZGF0YTogdGRhdGF0aW1lLAogICAgICAgICAgICAgICAgLy8g5a2X5pWw6LaF6L+HbuS4quaXtuecgeeVpQogICAgICAgICAgICAgICAgYXhpc0xhYmVsOiB7CiAgICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHZhbHVlLnN1YnN0cmluZygwLCA1KSArICcuLi4nOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPiA1ID8gdiA6IHZhbHVlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICBdLAogICAgICAgICAgICB5QXhpczoge30sCiAgICAgICAgICAgIHNlcmllczogWwogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIG5hbWU6IHRpdGxlLAogICAgICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICAgICAgZGF0YTogdHZhbHVlLAogICAgICAgICAgICAgICAgaXRlbVN0eWxlOiB7CiAgICAgICAgICAgICAgICAgIC8vIOWbvuW9oueahOminOiJsuOAgum7mOiupOaMh+WQkeWFqOWxgOeahG9wdGlvbi5jb2xvcgogICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3IKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH07CiAgICAgICAgICBpZiAoaWQgPT09ICd0ZW1wZXJhdHVyZScpIHsKICAgICAgICAgICAgdGhhdC5kYXRhVCA9IG9wdGlvbjsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChpZCA9PT0gJ2h1bWlkaXR5JykgewogICAgICAgICAgICB0aGF0LmRhdGFIID0gb3B0aW9uOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGlkID09PSAnaWxsdW1pbmF0aW9uJykgewogICAgICAgICAgICB0aGF0LmRhdGFMID0gb3B0aW9uOwogICAgICAgICAgfQogICAgICAgICAgbXlDaGFydC5zZXRPcHRpb24ob3B0aW9uKTsKICAgICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["History.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"History.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"box\">\n    <div class=\"nullview\"></div>\n    <van-form>\n      <van-field\n        v-model=\"dataNum\"\n        center\n        label=\"数据数量\"\n        clearable\n        placeholder=\"1 ~ 330\"\n        :rules=\"[{ pattern, message: '请输入正确的数字', trigger: 'onBlur' }]\"\n      >\r\n\t\t\t\t<template #button>\r\n\t\t\t\t\t<van-button size=\"small\" type=\"primary\" @click=\"selectData\"\r\n\t\t\t\t\t\t>查询</van-button\r\n\t\t\t\t\t>\r\n\t\t\t\t</template>\n      </van-field>    \n    </van-form>\n    <van-tabs color=\"#888686\" @click=\"tabClick\">\n      <van-tab title=\"温度\">\n        <div class=\"line\">\n          <div id=\"main\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n      <van-tab title=\"湿度\">\n        <div class=\"line\">\n          <div id=\"main1\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n      <van-tab title=\"光照强度\">\n        <div class=\"line\">\n          <div id=\"main2\" style=\"width: 100%; height: 400px\"></div>\n        </div>\n      </van-tab>\n    </van-tabs>\n  </div>\n</template>\n\n<script>\nconst echarts = require('echarts');\nconst devicesid = '624519850'; // 设备id\nconst apikey = '2oc6=0XgNsKFW8XVsGcpSJmdlL0='; //\nconst api = new OneNetApi(apikey);\n\nexport default {\n  created() {\n    // 获取温度的数据节点\n    this.getCharts('temperature', '温度', '#F60', 'main');\n  },\n  data() {\n    return {\n      flag: true,\n      flag1: true,\n      value: '2021-05-01',\n      dataNum: '',\n      limit: 6000,\n      startTime: '2020-12-30T08:00:35',\n      dataL: {},\n      dataH: {},\n      dataT: {},\n      pattern: /^([1-9][0-9]|[1-2][0-9][0-9]|[3][0-2][0-9]|330)$/\n    };\n  },\n  mounted() {},\n  methods: {\n    tabClick(title) {\n      if (title === 1 && this.flag) {\n        this.flag = !this.flag;\n        this.getCharts('humidity', '湿度', '#1be0e0', 'main1');\n      } else if (title === 2 && this.flag1) {\n        this.flag1 = !this.flag1;\n        // //获取光照度的数据节点\n        this.getCharts('illumination', '光照强度', '#19c509', 'main2');\n      }\n    },\n    selectData() {\n      // 查询按钮\n      const that = this;\n      const dataNums = Number(that.dataNum);\n      that.limit = dataNums;\n      that.getCharts('temperature', '温度', '#F60', 'main');\n      that.getCharts('humidity', '湿度', '#1be0e0', 'main1');\n      that.getCharts('illumination', '光照强度', '#19c509', 'main2');\n    },\n    getCharts(id, title, color, who) {\n      // 实例化图表\n      const that = this;\n      api\n        .getDataPoints(devicesid, {\n          datastream_id: id,\n          start: that.startTime,\n          limit: that.limit\n        })\n        .done(function(data) {\n          console.log('api调用完成，服务器返回data为：', data);\n          const tdatatime = [];\n          const tvalue = [];\n          const datas = data.data.datastreams[0].datapoints;\n          for (const i in datas) {\n            datas[i].at = datas[i].at.slice(5, -4); // 去掉时间，保留日期\n            tdatatime.push(datas[i].at);\n            tvalue.push(datas[i].value);\n          }\n          // const echarts = require(\"echarts\");\n          // 基于准备好的dom，初始化echarts实例\n          const myChart = echarts.init(document.getElementById(who));\n          // 绘制图表\n          const option = {\n            legend: {\n              data: [title]\n            },\n            tooltip: {},\n            toolbox: {\n              feature: {\n                // 动态类型切换,切换图表\n                magicType: {\n                  type: ['line', 'bar']\n                },\n                // 数据视图工具，可以展现当前图表所用的数据，编辑后可以动态更新。\n                dataView: {\n                  show: true, // 是否显示 数据示图\n                  readOnly: false // 是否 直接可以编辑数据。\n                },\n                // 保存为图片的配置\n                saveAsImage: {\n                  show: true\n                },\n                // 配置项还原\n                restore: { show: true }\n              }\n            },\n            xAxis: [\n              {\n                data: tdatatime,\n                // 字数超过n个时省略\n                axisLabel: {\n                  formatter: function(value, index) {\n                    const v = value.substring(0, 5) + '...';\n                    return value.length > 5 ? v : value;\n                  }\n                }\n              }\n            ],\n            yAxis: {},\n            series: [\n              {\n                name: title,\n                type: 'line',\n                data: tvalue,\n                itemStyle: {\n                  // 图形的颜色。默认指向全局的option.color\n                  color: color\n                }\n              }\n            ]\n          };\n          if (id === 'temperature') {\n            that.dataT = option;\n          }\n          if (id === 'humidity') {\n            that.dataH = option;\n          }\n          if (id === 'illumination') {\n            that.dataL = option;\n          }\n          myChart.setOption(option);\n        });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.box {\n  width: 100%;\n  height: 100%;\n  .nullview {\n    width: 100%;\n    height: 50px;\n  }\n  .line {\n    width: 99%;\n    height: 400px;\n    margin-top: 20px;\n    // color: #888686;\n  }\n}\n</style>\n"]}]}